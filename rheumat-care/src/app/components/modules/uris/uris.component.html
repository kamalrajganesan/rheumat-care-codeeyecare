<div class="card module-card">
  <div class="moduleTitle">
    <h2>URIS – Uvea–Rheumat Interface Sheet</h2>
    <span class="pill" [class.ok]="completed">{{ completed ? 'Complete' : 'Pending' }}</span>
  </div>

  <form [formGroup]="urisForm">
    <!-- Visit -->
    <label for="visit">Visit</label>
    <select id="visit" formControlName="visit">
      <option value="">Select…</option>
      <option *ngFor="let type of visitTypes" [value]="type">{{ type }}</option>
    </select>

    <!-- Laterality -->
    <label for="laterality">Laterality</label>
    <select id="laterality" formControlName="laterality">
      <option value="">Select…</option>
      <option *ngFor="let option of lateralityOptions" [value]="option">{{ option }}</option>
    </select>

    <div class="miniGrid3">
      <div></div>
      <div class="small header-label">OD</div>
      <div class="small header-label">OS</div>
    </div>

    <div class="miniGrid3">
      <div><label>Uveitis Status</label></div>
      <div>
        <select formControlName="uveitisStatusOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let status of uveitisStatuses" [value]="status">{{ status }}</option>
        </select>
      </div>
      <div>
        <select formControlName="uveitisStatusOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let status of uveitisStatuses" [value]="status">{{ status }}</option>
        </select>
      </div>
    </div>

    <div class="divider"></div>

    <!-- Uveitis anatomical type, Uveitis nature -->
    <div class="miniGrid3">
      <div></div>
      <div class="small header-label">OD</div>
      <div class="small header-label">OS</div>
    </div>

    <div class="miniGrid3">
      <div><label>Uveitis Anatomical Type</label></div>
      <div>
        <select formControlName="anatomicalTypeOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let type of anatomicalTypes" [value]="type">{{ type }}</option>
        </select>
      </div>
      <div>
        <select formControlName="anatomicalTypeOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let type of anatomicalTypes" [value]="type">{{ type }}</option>
        </select>
      </div>
    </div>

    <div class="miniGrid3">
      <div><label>Uveitis Nature</label></div>
      <div>
        <select formControlName="natureOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of natureOptions" [value]="option">{{ option }}</option>
        </select>
      </div>
      <div>
        <select formControlName="natureOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of natureOptions" [value]="option">{{ option }}</option>
        </select>
      </div>
    </div>

    <div class="miniGrid3">
      <div><label>FFA</label></div>
      <div>
        <select formControlName="ffaOD">
          <option *ngFor="let option of ffaOptions" [value]="option">{{ option }}</option>
        </select>
      </div>
      <div>
        <select formControlName="ffaOS">
          <option *ngFor="let option of ffaOptions" [value]="option">{{ option }}</option>
        </select>
      </div>
    </div>

    <div class="divider"></div>

    <!-- Episode pattern, Number of episodes, Was prior treatment course completed? -->
    <div class="miniGrid3">
      <div></div>
      <div class="small header-label">OD</div>
      <div class="small header-label">OS</div>
    </div>

    <div class="miniGrid3">
      <div><label>Episode Pattern</label></div>
      <div>
        <select formControlName="episodePatternOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let pattern of episodePatterns" [value]="pattern">{{ pattern }}</option>
        </select>
      </div>
      <div>
        <select formControlName="episodePatternOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let pattern of episodePatterns" [value]="pattern">{{ pattern }}</option>
        </select>
      </div>
    </div>

    <div class="miniGrid3">
      <div><label>Number of episodes (last 1–2 years)</label></div>
      <div>
        <select formControlName="episodesCountOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let count of episodeCounts" [value]="count">{{ count }}</option>
        </select>
      </div>
      <div>
        <select formControlName="episodesCountOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let count of episodeCounts" [value]="count">{{ count }}</option>
        </select>
      </div>
    </div>

    <div class="miniGrid3">
      <div><label>Was prior treatment course completed?</label></div>
      <div>
        <select formControlName="priorCourseCompletedOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of courseCompletedOptions" [value]="option">{{ option }}</option>
        </select>
      </div>
      <div>
        <select formControlName="priorCourseCompletedOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of courseCompletedOptions" [value]="option">{{ option }}</option>
        </select>
      </div>
    </div>

    <div class="divider"></div>

    <!-- Current Topical treatment -->
    <h2 class="section-title">Current Topical treatment</h2>

    <div class="miniGrid3">
      <div></div>
      <div class="small header-label">OD</div>
      <div class="small header-label">OS</div>
    </div>

    <div class="miniGrid3">
      <div><label>Topical Steroids</label></div>
      <div>
        <select formControlName="topicalSteroidsOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of yesNoOptions" [value]="option">{{ option }}</option>
        </select>
        <input *ngIf="showSteroidsNameOD()" type="text" formControlName="topicalSteroidsNameOD" placeholder="Name / dose" [attr.disabled]="isODDisabled() ? true : null" />
      </div>
      <div>
        <select formControlName="topicalSteroidsOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of yesNoOptions" [value]="option">{{ option }}</option>
        </select>
        <input *ngIf="showSteroidsNameOS()" type="text" formControlName="topicalSteroidsNameOS" placeholder="Name / dose" [attr.disabled]="isOSDisabled() ? true : null" />
      </div>
    </div>

    <div class="miniGrid3">
      <div><label>Topical NSAID</label></div>
      <div>
        <select formControlName="topicalNSAIDOD" [attr.disabled]="isODDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of yesNoOptions" [value]="option">{{ option }}</option>
        </select>
        <input *ngIf="showNSAIDNameOD()" type="text" formControlName="topicalNSAIDNameOD" placeholder="Name / dose" [attr.disabled]="isODDisabled() ? true : null" />
      </div>
      <div>
        <select formControlName="topicalNSAIDOS" [attr.disabled]="isOSDisabled() ? true : null">
          <option value="">Select…</option>
          <option *ngFor="let option of yesNoOptions" [value]="option">{{ option }}</option>
        </select>
        <input *ngIf="showNSAIDNameOS()" type="text" formControlName="topicalNSAIDNameOS" placeholder="Name / dose" [attr.disabled]="isOSDisabled() ? true : null" />
      </div>
    </div>

    <div class="divider"></div>

    <!-- Likely / confirmed diagnosis -->
    <label>Likely / confirmed diagnosis (tick that applies)</label>
    <div class="checks">
      <label *ngFor="let diagnosis of diagnoses" class="check">
        <input
          type="checkbox"
          [checked]="isDiagnosisChecked(diagnosis)"
          (change)="onDiagnosisChange(diagnosis, $event)"
        />
        <span>{{ diagnosis }}</span>
      </label>
    </div>

    <label for="finalDiagnosis">Final uveitis diagnosis (if known)</label>
    <input
      type="text"
      id="finalDiagnosis"
      formControlName="finalDiagnosis"
      placeholder="(optional)"
    />

    <div class="divider"></div>

    <!-- Coordination / action items -->
    <h2 class="section-title">Coordination / action items</h2>
    <div class="checks onecol">
      <label *ngFor="let item of actionItems" class="check">
        <input
          type="checkbox"
          [checked]="isActionItemChecked(item)"
          (change)="onActionItemChange(item, $event)"
        />
        <span>{{ item }}</span>
      </label>
    </div>

    <!-- Need rheumatology clearance for surgery? -->
    <label for="surgeryClearance">Need rheumatology clearance for surgery?</label>
    <select id="surgeryClearance" formControlName="surgeryClearance">
      <option value="">Select…</option>
      <option *ngFor="let option of surgeryClearanceOptions" [value]="option">{{ option }}</option>
    </select>

    <!-- Ophthalmologist input -->
    <label for="ophInput">Ophthalmologist Input</label>
    <textarea id="ophInput" formControlName="ophthalmologistInput"></textarea>

    <div class="divider"></div>
    <button class="primary" type="button" (click)="markComplete()">Mark URIS complete</button>
  </form>
</div>
